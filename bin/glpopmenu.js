!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(t,e,i){for(var n=!0;n;){var r=t,s=e,a=i;h=u=o=void 0,n=!1,null===r&&(r=Function.prototype);var h=Object.getOwnPropertyDescriptor(r,s);if(void 0!==h){if("value"in h)return h.value;var o=h.get;return void 0===o?void 0:o.call(a)}var u=Object.getPrototypeOf(r);if(null===u)return void 0;t=u,e=s,i=a,n=!0}},h=i(1),o=i(4),u=i(3),l=(i(2),Symbol()),c=Symbol(),f=function(t){function e(t){var i=this;if(n(this,e),t!==c)throw"大兄弟，俺是个单例类啊";a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.width=0,this.tapRanges=[],this.movedIndex=0,this.currentScale=this.currentAlpha=0,this.currentTranslate=30,this.isShow=!1,this.svg=new h.GLSVG,this.svg.domElement.addEventListener("mouseup",function(t){i.menuTapped(t)},!1),this.svg.domElement.addEventListener("touchend",function(t){i.menuTapped(t)},!1)}return r(e,t),s(e,[{key:"setMenuItems",value:function(t){this.parseItems(t)}},{key:"ifNeedsDisplay",value:function(t,e){this.isShow===!0?this.quitDisplay():(this.svg.setPosition(t,e),this.dispaly())}},{key:"dispaly",value:function(){this.isShow=!0,this.svg.domElement.style.opacity=this.currentAlpha=0,this.svg.domElement.style.visibility="visible",this.startAnimating()}},{key:"quitDisplay",value:function(){this.isShow=!1,this.startAnimating()}},{key:"stopAnimating",value:function(){a(Object.getPrototypeOf(e.prototype),"stopAnimating",this).call(this),this.isShow===!1&&(this.svg.domElement.style.visibility="hidden")}},{key:"enterFrame",value:function(){this.isAnimating=!0,this.isShow===!0?this.currentAlpha+=.07:this.currentAlpha-=.09,this.currentAlpha<0||this.currentAlpha>1?(this.currentAlpha=this.currentAlpha<0?0:1,this.stopAnimating()):a(Object.getPrototypeOf(e.prototype),"enterFrame",this).call(this),this.svg.domElement.style.opacity=this.currentAlpha}},{key:"menuTapped",value:function(t){var e,i,n=this.svg.frame;e=t.pageX-n.x,i=t.pageY-n.y;for(var r=0;r<this.tapRanges.length;r++)if(e<this.tapRanges[r].to){this.tapRanges[r].callback(),this.quitDisplay();break}}},{key:"parseItems",value:function(t){this.tapRanges=[];for(var e=0,i=10,n=i,r=0;r<t.length;r++){var s=t[r].text,a=16*s.length+2*i,h=n+a;this.tapRanges[r]={text:s,from:n,to:h,center:n+a/2,callback:t[r].callback},e+=s.length,n=h}var o=this.tapRanges[t.length-1];o.to=o.to+i,this.width=o.to,this.svg.width=this.width,this.svg.textItems=this.tapRanges}}],[{key:"instance",get:function(){return this[l]||(this[l]=new e(c)),this[l]}}]),e}(o.IAnimation);e.GLPopMenu=f,window.GLPopMenu=f,window.GLPoint=u.GLPoint},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(2),a=function(){function t(){n(this,t),this.isUpDirection=!1,this.minWidth=64,this.directionOffsetY=5,this.textItems=null,this.parentElement=null,this.frame=new s.GLRect(100,100,64,54),this.marginLeft=5,this.marginRight=5,this.screenWidth=window.innerWidth,this.maxFrameX=this.screenWidth-this.marginRight,this.angleOffsetX=0,this.domElement=this.createSVGElement()}return r(t,[{key:"setPosition",value:function(t,e){t!==this.parentElement&&(this.parentElement&&this.parentElement.removeChild(this.domElement),t.appendChild(this.domElement),this.parentElement=t),this.frame.center=GLPoint.copy(e);var i=this.frame.height+this.directionOffsetY;e.y<i?(this.isUpDirection=!0,this.frame.y=e.y+this.directionOffsetY):(this.isUpDirection=!1,this.frame.y=e.y-i);var n=0;this.frame.x<this.marginLeft?(n=this.frame.x-this.marginLeft,this.frame.x=this.marginLeft):this.frame.getMaxX()>this.maxFrameX&&(n=this.frame.getMaxX()-this.maxFrameX,this.frame.x=this.maxFrameX-this.frame.width),this.angleOffsetX=this.validateAngleOffsetX(n),this.domElement.style.top=this.frame.y,this.domElement.style.left=this.frame.x,this.calculateBorder(),this.attachText()}},{key:"validateAngleOffsetX",value:function(t){var e=this.frame.halfWidth-13;return this.isUpDirection&&(t*=-1),-e>t?t=-e:t>e&&(t=e),t}},{key:"attachText",value:function(){var t=this.domElement.getElementById("backgroundGroup"),e=23;this.isUpDirection?(e=40,t.setAttribute("transform","translate("+this.frame.halfWidth+", "+this.frame.halfHeight+") rotate(180) translate("+-1*this.frame.halfWidth+", "+-1*this.frame.halfHeight+")")):t.setAttribute("transform","rotate(0)");for(var i=this.domElement.getElementById("group"),n=i.querySelectorAll("text"),r=0;r<this.textItems.length;r++){var s=n[r];s.setAttribute("x",this.textItems[r].center),s.setAttribute("y",e),s.textContent=this.textItems[r].text}}},{key:"calculateBorder",value:function(){var t=3,e=8,i=12,n=.5,r=this.frame.width-1,s=.5,a=36,h=r/2+this.angleOffsetX,o="M"+(n+t)+" "+s+" L"+(r-t)+" "+s+" A"+t+" "+t+" 0 0 1 "+r+" "+(s+t)+" L"+r+" "+(a-t)+" A"+t+" "+t+" 0 0 1 "+(r-t)+" "+a+" L"+(h+i/2)+" "+a+" L"+h+" "+(a+e)+" L"+(h-i/2)+" "+a+" L"+(n+t)+" "+a+" A"+t+" "+t+" 0 0 1 "+n+" "+(a-t)+" L"+n+" "+(s+t)+" A"+t+" "+t+" 0 0 1 "+(n+t)+" "+s,u=this.domElement.getElementById("borderPath");u.setAttribute("d",o)}},{key:"createSVGElement",value:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttributeNS(null,"id","glpopmenu"),t.setAttributeNS(null,"x",0),t.setAttributeNS(null,"y",0),t.setAttributeNS(null,"width",this.minWidth),t.setAttributeNS(null,"height",this.frame.height),t.setAttributeNS(null,"style","cursor:hand;display:block;z-index:10000; position: absolute; visibility:visiable;"),t.innerHTML='\n          <symbol id="border">\n            <path  id="borderPath" d="M3.5 0.5 L256 0.5 A3 3 0 0 1 259 3.5 L259 33 A3 3 0 0 1 256 36 L135.5 36 L129.5 44 L123.5 36 L3.5 36 A3 3 0 0 1 0.5 33 L0.5 3.5 A3 3 0 0 1 3.5 0.5" />\n          </symbol>\n          <defs>\n            <mask id="alphaMask" x="0" y="0" width="400" height="54">\n              <rect x="0" y="0" width="400" height="54" style="stroke:none; fill: #333333" />\n            </mask>\n          </defs>\n          <g id="backgroundGroup" transform="rotate(0)">\n            <!-- 阴影 -->\n            <use xlink:href="#border" x="0" y="3" style="fill:#000000;stroke-width:0; mask:url(#alphaMask); " />\n            <use xlink:href="#border" x="0" y="0" style="fill:#555;stroke:#353535;stroke-width:1;" />\n          </g>\n\n          <g id="group" style="font-size:16px;fill:#eeeeee;text-anchor: middle">\n            <!-- 动态插入进来的文本节点在Safari上无法显示，故事先创建好文本节点 -->\n            <text x="0" y="23" ></text>\n            <text x="0" y="23" ></text>\n            <text x="0" y="23" ></text>\n            <text x="0" y="23" ></text>\n            <text x="0" y="23" ></text>\n            <text x="0" y="23" ></text>\n            <text x="0" y="23" ></text>\n          </g>\n        ',t}},{key:"width",set:function(t){this.frame.width=t<this.minWidth?this.minWidth:t,this.domElement.setAttribute("width",t)}}]),t}();e.GLSVG=a},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(3),a=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],a=arguments.length<=3||void 0===arguments[3]?0:arguments[3];n(this,t),this._x=e,this._y=i,this._width=r,this._height=a,this.halfWidth=r/2,this.halfHeight=a/2,this._center=new s.GLPoint(e+this.halfWidth,i+this.halfHeight)}return r(t,[{key:"setPosition",value:function(t){this.x=t.x,this.y=t.y}},{key:"getPosition",value:function(){return new s.GLPoint(this.x,this.y)}},{key:"getMaxX",value:function(){return this.x+this._width}},{key:"getMaxY",value:function(){return this.y+this._height}},{key:"converPoint",value:function(t){return new s.GLPoint(t.x-this.x,t.y-this.y)}},{key:"convertRect",value:function(e){return new t(e.x-this.x,e.y-this.y,e.width,e.height)}},{key:"center",set:function(t){this._center=t,this._x=this._center.x-this.halfWidth,this._y=this._center.y-this.halfHeight},get:function(){return this._center}},{key:"width",set:function(t){this._width=t,this.halfWidth=t/2,this._center.x=this._x+this.halfWidth},get:function(){return this._width}},{key:"height",set:function(t){this._height=t,this.halfHeight=t/2,this._center.y=this._y+this.halfHeight},get:function(){return this._height}},{key:"x",set:function(t){this._x=t,this._center.x=this._x+this.halfWidth},get:function(){return this._x}},{key:"y",set:function(t){this._y=t,this._center.y=this._y+this.halfHeight},get:function(){return this._y}}]),t}();e.GLRect=a},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];i(this,t),this.x=e,this.y=n}return n(t,[{key:"isEqualTo",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"converPoint",value:function(e){return new t(e.x-this.x,e.y-this.y)}}],[{key:"zero",value:function(){return new t}},{key:"copy",value:function(e){return new t(e.x,e.y)}}]),t}();e.GLPoint=r},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(){i(this,t),this.animationHandler=null,this.isAnimating=!1}return n(t,[{key:"startAnimating",value:function(){this.isAnimating=!0,this.requestAnimation()}},{key:"stopAnimating",value:function(){cancelAnimationFrame(this.animationHandler),this.isAnimating=!1}},{key:"enterFrame",value:function(){this.requestAnimation()}},{key:"requestAnimation",value:function(){var t=this;this.animationHandler=requestAnimationFrame(function(){t.enterFrame()})}},{key:"destory",value:function(){this.stopAnimating()}}]),t}();e.IAnimation=r}]);